<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artale å›°é›£æ‹‰åœ–æ–¯æ§æ™‚ç·´ç¿’å™¨</title>
    <style>
        :root {
            --card-bg: rgba(22, 27, 34, 0.98);
            --primary-gold: #f1c40f;
            --clock-blue: #d7ede9;
            --accent-blue: #58a6ff;
            --text-main: #e6edf3;
            --text-dim: #8b949e;
            --border-color: #30363d;
            --neon-orange: #ff8a00;
            --neon-orange-bright: #ffaa44;
            --neon-green: #00ff7f;
        }

        body {
            background: radial-gradient(circle, #161b22 0%, #0d1117 100%);
            color: var(--text-main);
            font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 15px;
            box-sizing: border-box;
        }

        .game-wrapper {
            position: relative;
            background: var(--card-bg);
            padding: 20px 30px;
            border-radius: 20px;
            border: 1.5px solid rgba(188, 19, 254, 0.5);
            box-shadow: 
                0 0 10px rgba(188, 19, 254, 0.6),
                0 0 25px rgba(188, 19, 254, 0.4),
                0 0 45px rgba(188, 19, 254, 0.2),
                0 20px 50px rgba(0, 0, 0, 0.8);
            text-align: center;
            width: 100%;
            max-width: 400px;
            min-height: 800px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }

        /* --- å‹•ç•« --- */
        .fade-out { animation: fadeOutEffect 0.5s forwards ease-in-out !important; pointer-events: none; }
        .fade-in { animation: fadeInEffect 0.5s forwards ease-in-out !important; }
        @keyframes fadeOutEffect { from { opacity: 1; } to { opacity: 0; } }
        @keyframes fadeInEffect { from { opacity: 0; } to { opacity: 1; } }

        /* --- é¦–é  --- */
        #home-screen {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            gap: 10px;
            padding-top: 30px;
        }

        .home-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffffff;
            text-shadow: 0 0 8px rgba(88, 166, 255, 0.9), 0 0 15px rgba(88, 166, 255, 0.6), 0 0 25px rgba(0, 112, 255, 0.4), 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin: 0 0 20px 0;
            line-height: 1.4;
            letter-spacing: 1.5px;
        }

        .home-image {
            width: 100%;
            max-width: 360px;
            height: auto;
            border-radius: 10px;
            filter: drop-shadow(0 0 20px rgba(88, 166, 255, 0.3));
        }

        .footer-credit {
            margin-top: 15px;
            font-size: 0.85rem;
            color: #ffffff;
            opacity: 0.8;
            letter-spacing: 1.5px;
            font-family: "Courier New", monospace;
            text-shadow: 0 0 5px rgba(88, 166, 255, 0.8), 0 0 10px rgba(88, 166, 255, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .footer-icon { width: 20px; height: auto; filter: drop-shadow(0 0 5px rgba(88, 166, 255, 0.5)); }

        /* --- æŒ‰éˆ•é€šç”¨å±¬æ€§ --- */
        .primary-btn, #end-btn, #next-btn {
            padding: 15px;
            font-size: 1.1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease-in-out !important;
            display: block;
            width: 100%;
            box-sizing: border-box;
            letter-spacing: 2px;
            text-transform: uppercase;
            font-weight: normal !important;
        }

        /* --- é¦–é æŒ‰éˆ•æ¨£å¼ --- */
        .primary-btn {
            background: #21262d !important;
            color: #ffffff !important;
            border: 2px solid rgba(255, 255, 255, 0.8) !important;
            margin-top: 20px;
        }

        #settings-btn { border-style: dashed !important; opacity: 0.9; }

        .primary-btn:hover {
            background: rgba(88, 166, 255, 0.15) !important;
            border: 2px solid #ffffff !important;
            border-style: solid !important;
            transform: translateY(-3px) !important;
            box-shadow: 0 0 15px rgba(88, 166, 255, 0.8), 0 0 30px rgba(88, 166, 255, 0.4), inset 0 0 10px rgba(88, 166, 255, 0.4) !important;
            text-shadow: 0 0 8px rgba(255, 255, 255, 1), 0 0 15px rgba(88, 166, 255, 0.8) !important;
            opacity: 1;
        }

        /* --- éŠæˆ²å…§æ§åˆ¶æŒ‰éˆ•ï¼šçµæŸ & ä¸‹ä¸€é¡Œ --- */
        #end-btn, #next-btn {
            border: 2px solid #ffffff !important;
            margin-top: 20px;
        }

        #end-btn {
            background: rgba(255, 138, 0, 0.05) !important;
            color: #ffffff !important;
            text-shadow: 0 0 5px rgba(255, 138, 0, 0.8), 0 0 10px rgba(255, 138, 0, 0.5) !important;
            box-shadow: 0 0 8px rgba(255, 138, 0, 0.4), inset 0 0 4px rgba(255, 138, 0, 0.3) !important;
        }

        #next-btn {
            background: rgba(0, 255, 127, 0.05) !important;
            color: #ffffff !important;
            text-shadow: 0 0 5px rgba(0, 255, 127, 0.8), 0 0 10px rgba(0, 255, 127, 0.5) !important;
            box-shadow: 0 0 8px rgba(0, 255, 127, 0.4), inset 0 0 4px rgba(0, 255, 127, 0.3) !important;
        }

        #end-btn:hover:not(:disabled) {
            background: rgba(255, 138, 0, 0.15) !important;
            transform: translateY(-3px) !important;
            box-shadow: 0 0 15px rgba(255, 138, 0, 0.8), 0 0 30px rgba(255, 138, 0, 0.4), inset 0 0 10px rgba(255, 138, 0, 0.4) !important;
            text-shadow: 0 0 8px rgba(255, 138, 0, 1), 0 0 15px rgba(255, 138, 0, 0.8) !important;
        }

        #next-btn:hover:not(:disabled) {
            background: rgba(0, 255, 127, 0.15) !important;
            transform: translateY(-3px) !important;
            box-shadow: 0 0 15px rgba(0, 255, 127, 0.8), 0 0 30px rgba(0, 255, 127, 0.4), inset 0 0 10px rgba(0, 255, 127, 0.4) !important;
            text-shadow: 0 0 8px rgba(0, 255, 127, 1), 0 0 15px rgba(0, 255, 127, 0.8) !important;
        }

        .primary-btn:active, #end-btn:active, #next-btn:active { transform: translateY(0) !important; }

        /* --- éŠæˆ²ç•«é¢çµ„ä»¶ --- */
        #back-to-home, #game-settings-btn { position: absolute; top: 15px; font-size: 1.5rem; cursor: pointer; z-index: 20; transition: transform 0.2s; user-select: none; }
        #back-to-home { left: 15px; } #game-settings-btn { right: 15px; }
        #back-to-home:hover { transform: scale(1.2); }
        #game-settings-btn:hover { transform: scale(1.2) rotate(45deg); }

        #result-area { margin: 20px 0 10px 0; height: 60px; display: flex; align-items: center; justify-content: center; }
        #message { margin: 0; font-size: 1.3rem; font-weight: bold; }

        .timer-area { width: 100%; max-width: 180px; aspect-ratio: 200/60; background: url('https://images.plurk.com/3aMmUYdcZdgMBClnxf4Qir.png') center/100% 100% no-repeat; margin: 0 auto 25px auto; position: relative; }
        #static-zero, #countdown-timer { font-family: "Courier New", monospace; font-size: 2.3rem; font-weight: bold; color: #fbf9c2; letter-spacing: -2px; position: absolute; top: 53%; transform: translateY(-50%); width: 35%; text-align: center; text-shadow: 0 0 5px rgba(251, 249, 194, 0.8), 0 0 10px rgba(251, 249, 194, 0.5); }
        #static-zero { left: 28%; } #countdown-timer { left: 60%; }

        .button-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 25px; }
        #button-container button { padding: 8px; aspect-ratio: 1; display: flex; align-items: center; justify-content: center; background: rgba(48, 54, 61, 0.4); border: 2px solid rgba(255, 255, 255, 0.5) !important; border-radius: 10px; cursor: pointer; transition: all 0.3s; }
        #button-container button:hover:not(:disabled) { background: rgba(65, 71, 79, 0.8); transform: translateY(-2px); border-color: rgba(255, 255, 255, 0.6) !important; box-shadow: 0 0 12px rgba(255, 255, 255, 0.4); }
        #button-container button:disabled { opacity: 0.3; filter: grayscale(1); cursor: default; }

        .clock-display-area { width: 100%; aspect-ratio: 16/9; background: url('https://images.plurk.com/1bTdt9DiaQ0N4WQJPNH9XA.png') center/100% 100% no-repeat; position: relative; margin-bottom: 20px; filter: brightness(0.9); }
        .time-container { position: absolute; top: 48.5%; left: 49.5%; transform: translate(-50%, -50%); width: 100%; }
        #current-time { font-family: "Courier New", monospace; font-size: 0.85rem; font-weight: bold; color: var(--clock-blue); text-shadow: 0 0 5px rgba(215, 237, 233, 0.9), 0 0 10px rgba(88, 166, 255, 0.6); }

        #result-overlay { display: none; position: absolute; inset: 0; z-index: 10; background: center/contain no-repeat; pointer-events: none; animation: resultAppear 1.2s ease-out forwards; }
        @keyframes resultAppear { from { opacity: 0; } to { opacity: 1; } }

        #best-solution-container { display: none; opacity: 0; }
        #best-solution-box { color: var(--clock-blue); background: rgba(88, 166, 255, 0.03); padding: 20px 20px 0px 20px; border-radius: 4px; text-align: left; margin-top: 25px; border: 1px solid rgba(88, 166, 255, 0.2); }
        .result-row { display: flex; margin-bottom: 12px; border-bottom: 1px solid rgba(88, 166, 255, 0.08); padding-bottom: 10px; }
        .result-row strong { min-width: 75px; font-size: 0.8rem; opacity: 0.75; }
        #res-initial, #res-target, #res-options, #res-steps { font-family: "Courier New", monospace; font-size: 0.8rem; font-weight: bold; }
        #res-options, #res-steps { color: var(--primary-gold); }
    </style>
</head>
<body>

<div class="game-wrapper">
    <div id="home-screen">
        <h1 class="home-title">Artaleå›°é›£æ‹‰åœ–æ–¯æ§æ™‚ç·´ç¿’å™¨</h1>
        <img src="https://images.plurk.com/5muV8QHj5HfJbel1mtXAUS.png" alt="Papulatus" class="home-image">
        <button id="start-btn" class="primary-btn">é–‹å§‹éŠæˆ²</button>
        <button id="settings-btn" class="primary-btn">é¸é …è¨­ç½®</button>
        <img src="https://images.plurk.com/6FNrTJuuuvcZvjshnAMq6U.png" alt="Decoration" style="width: 100%; max-width: 360px; height: auto; margin-top: 10px;">
        <div class="footer-credit">
            <span>Created by è‘›è‘›z</span>
            <img src="https://images.plurk.com/5P62hQDFFdPW8pjHXQPKkH.png" alt="icon" class="footer-icon">
        </div>
    </div>

    <div id="game-screen" style="display: none;">
        <div id="back-to-home">â†©ï¸</div>
        <div id="game-settings-btn">âš™ï¸</div>
        <div id="result-area">
            <p id="message">è«‹é»é¸æŒ‰éˆ•æˆ–çµæŸæ§æ™‚</p>
        </div>
        <div class="timer-area">
            <span id="static-zero">00</span>
            <span id="countdown-timer">30</span>
        </div>
        <div class="button-grid" id="button-container"></div>
        <div class="clock-display-area">
            <div class="time-container">
                <span id="current-time">00:00</span>
            </div>
            <div id="result-overlay"></div>
        </div>
        <div class="controls">
            <button id="end-btn">çµæŸæ§æ™‚</button>
            <button id="next-btn" style="display:none;">ä¸‹ä¸€é¡Œ</button>
        </div>
        <div id="best-solution-container">
            <div id="best-solution-box">
                <div class="result-row"><strong>åˆå§‹æ™‚é–“ï¼š</strong><span id="res-initial"></span></div>
                <div class="result-row"><strong>å¯é¸é¸é …ï¼š</strong><span id="res-options"></span></div>
                <div class="result-row"><strong>å»ºè­°æ­¥é©Ÿï¼š</strong><span id="res-steps"></span></div>
                <div class="result-row"><strong>æœ€ä½³æ§æ™‚ï¼š</strong><span id="res-target"></span></div>
            </div>
        </div>
    </div>
</div>

<script>
const optionsPool = [
    { label: "10åˆ†", value: 10, img: "https://images.plurk.com/7pt8wSx3Xy07rygfZInZCr.png" },
    { label: "30åˆ†", value: 30, img: "https://images.plurk.com/59uCWHf3M1RoPc1UXJgfnS.png" },
    { label: "50åˆ†", value: 50, img: "https://images.plurk.com/1FaL0XeX7XAm0GXqpZnBUp.png" },
    { label: "2æ™‚", value: 120, img: "https://images.plurk.com/1PQ11IRH876A1rqkCwqOcX.png" },
    { label: "4æ™‚", value: 240, img: "https://images.plurk.com/3U1ODgTPfoziea90SFp3g7.png" },
    { label: "9æ™‚", value: 540, img: "https://images.plurk.com/2KWgNVfYEGu2AJWt2cej3v.png" },
    { label: "x2", value: "multiply", img: "https://images.plurk.com/3U2dQZsFpUMn00iElEUJb0.png" }
];

const RESULT_IMAGES = {
    PERFECT: "https://images.plurk.com/5zFNiX40JIIMuE0PtRb480.gif",
    FAILED: "https://images.plurk.com/53KHwJqN2UmP7FetY8LwjV.gif",
    OVER: "https://images.plurk.com/5Kg5s6ebU2vHDTBJ2ReXFn.gif",
    TIMEOUT: "https://images.plurk.com/5Kg5s6ebU2vHDTBJ2ReXFn.gif"
};

let currentMinutes = 0, initialMinutes = 0, currentButtons = [], timerInterval, timeLeft = 30;
const LIMIT = 720;

document.getElementById('start-btn').onclick = () => {
    const home = document.getElementById('home-screen');
    const game = document.getElementById('game-screen');
    home.classList.add('fade-out');
    setTimeout(() => {
        home.style.display = 'none';
        home.classList.remove('fade-out');
        game.style.display = 'block';
        game.classList.add('fade-in');
        initGame();
        setTimeout(() => game.classList.remove('fade-in'), 500);
    }, 500);
};

document.getElementById('back-to-home').onclick = () => {
    const home = document.getElementById('home-screen');
    const game = document.getElementById('game-screen');
    clearInterval(timerInterval);
    game.classList.add('fade-out');
    setTimeout(() => {
        game.style.display = 'none';
        game.classList.remove('fade-out');
        home.style.display = 'flex';
        home.classList.add('fade-in');
        setTimeout(() => home.classList.remove('fade-in'), 500);
    }, 500);
};

function initGame() {
    const bestContainer = document.getElementById('best-solution-container');
    bestContainer.style.display = "none";
    bestContainer.style.opacity = "0";
    bestContainer.classList.remove('fade-in', 'fade-out');

    const randomStep = Math.floor(Math.random() * 67);
    initialMinutes = (randomStep * 10) + 30;
    currentMinutes = initialMinutes;
    currentButtons = [];
    for (let i = 0; i < 4; i++) {
        currentButtons.push({ ...optionsPool[Math.floor(Math.random() * optionsPool.length)] });
    }
    
    const overlay = document.getElementById('result-overlay');
    overlay.style.display = "none";
    overlay.style.backgroundImage = "none";
    
    startTimer();
    updateTimeDisplay();
    renderButtons();
    
    const msg = document.getElementById('message');
    msg.innerText = "è«‹é»é¸æŒ‰éˆ•æˆ–çµæŸæ§æ™‚";
    msg.style.color = "#c9d1d9";
    
    document.getElementById('next-btn').style.display = "none";
    document.getElementById('end-btn').style.display = "block";
}

function startTimer() {
    clearInterval(timerInterval);
    timeLeft = 30;
    const timerDisplay = document.getElementById('countdown-timer');
    timerDisplay.innerText = "30";
    timerInterval = setInterval(() => {
        timeLeft--;
        timerDisplay.innerText = timeLeft.toString().padStart(2, '0');
        if (timeLeft <= 0) { clearInterval(timerInterval); finishGame(true); }
    }, 1000);
}

function renderButtons() {
    const container = document.getElementById('button-container');
    container.innerHTML = '';
    currentButtons.forEach((opt) => {
        const btn = document.createElement('button');
        btn.innerHTML = `<img src="${opt.img}" alt="${opt.label}" style="width:100%">`;
        btn.onclick = () => {
            if (opt.value === "multiply") currentMinutes *= 2;
            else currentMinutes += opt.value;
            btn.disabled = true;
            updateTimeDisplay();
            if (currentMinutes >= LIMIT) finishGame();
        };
        container.appendChild(btn);
    });
}

function updateTimeDisplay() {
    const h = Math.floor(currentMinutes / 60), m = currentMinutes % 60;
    document.getElementById('current-time').innerText = `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;
}

function solveBest() {
    let bestVal = -1, bestCombo = [];
    function find(cur, rem, path) {
        if (cur < LIMIT && cur > bestVal) { bestVal = cur; bestCombo = [...path]; }
        for (let i = 0; i < rem.length; i++) {
            let btn = rem[i];
            find(btn.value === "multiply" ? cur * 2 : cur + btn.value, rem.filter((_, idx) => idx !== i), [...path, btn.label]);
        }
    }
    find(initialMinutes, currentButtons, []);
    return { val: bestVal, combo: bestCombo };
}

function finishGame(isTimeout = false) {
    clearInterval(timerInterval);
    const best = solveBest(), msg = document.getElementById('message'), overlay = document.getElementById('result-overlay');
    
    document.getElementById('res-initial').innerText = `${Math.floor(initialMinutes/60).toString().padStart(2,'0')}:${(initialMinutes%60).toString().padStart(2,'0')}`;
    document.getElementById('res-options').innerText = currentButtons.map(b => b.label).join('ã€€');
    document.getElementById('res-target').innerText = `${Math.floor(best.val/60).toString().padStart(2,'0')}:${(best.val%60).toString().padStart(2,'0')}`;
    document.getElementById('res-steps').innerText = best.combo.join('â¡ï¸') || 'ä¸éœ€æ§æ™‚';

    const bestContainer = document.getElementById('best-solution-container');
    bestContainer.style.display = "block";
    void bestContainer.offsetWidth;
    bestContainer.classList.add('fade-in');

    overlay.style.display = "block";
    if (isTimeout) {
        msg.innerText = "ğŸ’€ æ™‚é–“åˆ° ğŸ’€"; msg.style.color = "#ff4757";
        overlay.style.backgroundImage = `url('${RESULT_IMAGES.TIMEOUT}')`;
    } else if (currentMinutes < LIMIT && currentMinutes >= best.val) {
        msg.innerText = "âœ¨ å®Œç¾æ§æ™‚ âœ¨"; msg.style.color = "#2ecc71";
        overlay.style.backgroundImage = `url('${RESULT_IMAGES.PERFECT}')`;
    } else if (currentMinutes >= LIMIT) {
        msg.innerText = "ğŸ’€ è¶…é12:00 ğŸ’€"; msg.style.color = "#ff4757";
        overlay.style.backgroundImage = `url('${RESULT_IMAGES.OVER}')`;
    } else {
        msg.innerText = "âš ï¸ æœªé”æœ€ä½³è§£ âš ï¸"; msg.style.color = "#f1c40f";
        overlay.style.backgroundImage = `url('${RESULT_IMAGES.FAILED}')`;
    }
    
    document.querySelectorAll('#button-container button').forEach(b => b.disabled = true);
    document.getElementById('end-btn').style.display = "none";
    document.getElementById('next-btn').style.display = "block";
}

document.getElementById('end-btn').onclick = () => finishGame(false);
document.getElementById('next-btn').onclick = () => {
    const bestContainer = document.getElementById('best-solution-container');
    bestContainer.classList.remove('fade-in');
    bestContainer.classList.add('fade-out');
    setTimeout(() => initGame(), 500);
};
</script>

</body>
</html>
